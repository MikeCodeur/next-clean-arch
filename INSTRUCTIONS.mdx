# Autorisation - Dynamique UI

### ğŸ’¡ Affichage Dynamique en fonction de lâ€™autorisation

## ğŸ“ Tes notes

Detaille ce que tu as appris ici,Â surÂ uneÂ pageÂ [Notion](https://go.mikecodeur.com/course-notes-template)

## Comprendre

Dans les exercices prÃ©cÃ©dents, nous avons bloquÃ© des routes en fonctions des rÃ´les, nous avons aussi protÃ©ger lâ€™appel aux actions.

Mais avec les rÃ¨gles dâ€™autorisation, il est possible de gÃ©rer des affichages diffÃ©rents, comme par exemple des boutons ou menus supplÃ©mentaires en fonction du type dâ€™utilisateur .

## Exercice

ğŸ‘¨â€âœˆï¸ Hugo le chef de projet te demande de conditionner lâ€™affichage des 2 buttons suivants en fonction du RÃ´le `Manager` ou `Admin`

- Ajout Rapide ([http://localhost:3000/shop-admin/1](http://localhost:3000/shop-admin/1))
- Ajout DÃ©taillÃ© ([http://localhost:3000/shop-admin/quick](http://localhost:3000/shop-admin/quick))

ğŸ¶ Pour cela tu vas devoir modifier les composants de routes (`page.tsx`) et utiliser

- `canQuickAdd`
- `canMutateProduct`

ps : Utilise la propriÃ©tÃ© `hidden` de `tailwind` et `cn` de `shadcn`

```tsx
className={cn({hidden: !canEdit})}
```

Fichiers

- `(dashboard)/shop-admin/[page]/page`
- `(dashboard)/shop-admin/quick/page`

## Bonus

### 1. ğŸš€ Menu Dynamique

**ğŸ‘¨â€âœˆï¸ Hugo le chef de projet** : te demande dâ€™avoir un menu du `dashboard` qui sâ€™adapte en fonction du rÃ´le.

- ğŸ¶ Utilise `hasRequiredRole` dans le `layout` du `dashboard` pour conditionner lâ€™affiche des menus

Exemple :

```tsx
const user = await getConnectedUser()
hasRequiredRole(user, RoleEnum.USER)
```

Fichiers

- `(dashboard)/layout.tsx`

### 2. ğŸš€ Menu Dynamique - Configuration

Les menus sont des choses qui bougent souvent et que lâ€™on peut retrouver dans diffÃ¨rent composants (`mobile-menu` / `menu-drawer` etc â€¦). Il est donc important de centraliser la configuration des menus en fonction des rÃ´les.

Pour cela nous avons ajouter un fichier `dashboard-menu.ts`

```tsx

export const dashboardMenu: Record<RoleEnum, MenuItem[]> = {
  [RoleEnum.GUEST]: [{label: 'Home', href: '/'}],
  [RoleEnum.USER]: [
    {label: 'Home', href: '/'},
    {label: 'Dashboard', href: '/dashboard'},
    {label: 'Bank', href: '/bank'},
  ],
  [RoleEnum.ADMIN]: [
    {label: 'Home', href: '/'},
    {label: 'Dashboard', href: '/dashboard'},
    {label: 'Admin', href: '/shop-admin/1'},
 ...
}
getMenuByRole
```

- **ğŸ¶ Utilise la fonction** `getMenuByRole` pour afficher le menu dynamiquement

```tsx
const menuItems = getMenuByRole(userRole)
...
 {menuItems.map((menuItem) => (
```

Fichiers

- `(dashboard)/layout.tsx`

## Ils vont tâ€™aider

- **ğŸ¶ Mowgli le Chien** : _Mowgli te guidera dans chaque exercice._
- **ğŸ¤– Ash le Robot** : _Ash le Robot te donnera du code utile._
- **ğŸš€ Julia La roquette** : _Julia te donnera des dÃ©fis supplÃ©mentaires._
- **â›ï¸ Hulk le Marteau** : _Quand du code Ã  supprimer est prÃ©sent_
- **ğŸ‘¨â€âœˆï¸ Hugo le chef de projet** : _Va t'aider sur les spÃ©cifications du projet_

## ğŸœ Feedback

Remplir le formulaire le [formulaire de FeedBack](https://go.mikecodeur.com/cours-next-avis?entry.1912869708=Next%20Mastery&entry.1430994900=Clean%20Architecture&entry.533578441=07%20Authorization%20dynamic-ui).
