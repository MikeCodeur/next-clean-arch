# Service Layout

### ğŸ’¡ Comprendre la couche service

## ğŸ“ Tes notes

Detaille ce que tu as appris ici,Â surÂ uneÂ pageÂ [Notion](https://go.mikecodeur.com/course-notes-template)

## Comprendre

Dans une architecture logicielle bien structurÃ©e, la **couche service** joue un rÃ´le clÃ© en tant qu'intermÃ©diaire entre la couche de prÃ©sentation et la couche de persistance (ou DAO).

Elle encapsule la logique mÃ©tier, c'est-Ã -dire toutes les rÃ¨gles et contraintes spÃ©cifiques au domaine d'application. En dÃ©composant l'architecture en plusieurs couches, on amÃ©liore la maintenabilitÃ©, la testabilitÃ© et la flexibilitÃ© de du code.

La couche service peut Ãªtre vue comme le **cerveau de votre application**. Elle s'assure que :

1. **Les donnÃ©es sont correctement validÃ©es** avant d'Ãªtre envoyÃ©es ou modifiÃ©es dans la base.
2. **Les erreurs sont traitÃ©es** de maniÃ¨re centralisÃ©e, offrant une expÃ©rience utilisateur cohÃ©rente et contrÃ´lÃ©e.
3. **La logique mÃ©tier est indÃ©pendante des technologies sous-jacentes**, rendant le code plus modulaire et adaptable.

### Pourquoi une couche service ?

1. **Centralisation de la logique mÃ©tier** :
   - Imaginez que vous devez vÃ©rifier qu'un utilisateur a un rÃ´le spÃ©cifique avant d'effectuer une action. PlutÃ´t que de rÃ©pÃ©ter cette rÃ¨gle dans plusieurs composants, la couche service centralise cette logique, ce qui Ã©vite les duplications et facilite les modifications futures.
2. **DÃ©couplage des couches** :
   - La couche prÃ©sentation (interface utilisateur) ne devrait pas interagir directement avec la base de donnÃ©es ou les ORM. En intercalant une couche service, on limite les dÃ©pendances directes, ce qui rend l'architecture plus propre et plus flexible.
3. **TestabilitÃ© accrue** :
   - En isolant la logique mÃ©tier dans une couche spÃ©cifique, il devient plus facile de la tester indÃ©pendamment des autres composants, par exemple en simulant les interactions avec les repositories ou autres services.

Nous avons ajouter cette configuration pour autoriser aucun import depuis `db` (meme les `repositories`)

```tsx
{
    files: ['src/app/**/*.{ts,tsx}'],
    rules: {
      'no-restricted-imports': [
        'error',
        {
          patterns: ['@/db/*', 'drizzle-orm'],
        },
      ],
    },
  },
```

### Quelques rÃ¨gles de nommage

Pour Ã©viter les collisions de noms nous utiliseront cette rÃ¨gle de nommage de fonction :

- `*Dao` pour les fonctions de la couche de persistance (ex : `createUserDao`)
- `*Service` pour les fonctions de la couche service (ex : `createUserService`)
- Et par la suite `*Action` pour les fonctions des servers action (ex : `createUserAction`)

## Exercice

Pour le moment la couche la prÃ©sentation appelle des repositories, cela isole dÃ©jÃ  de lâ€™ORM mais les repositories ne doivent pas contenir de logique mÃ©tier.

Le but de cet exercice est dâ€™introduire la couche service comme la

![course/layers.png](course/layers.png)

Dans un premier temps la couche service ne fera pas grand chose, mais petit a petit nous allons y ajouter de plus en plus de rÃ¨gles.

- **ğŸ¶** CrÃ©er les 2 services : `User` et `Product` : Ces services feront appel au repository pour accÃ©der aux donnÃ©es et auront des rÃ¨gles fonctionnelles simples (validation de donnÃ©es)
- Modifie ensuite `data-lib.ts` pour appeler ces services

Fichiers

- `exercise/data-lib.ts`
- `services/user-service.ts`
- `services/product-service.ts`

## Ils vont tâ€™aider

- **ğŸ¶ Mowgli le Chien** : _Mowgli te guidera dans chaque exercice._
- **ğŸ¤– Ash le Robot** : _Ash le Robot te donnera du code utile._
- **ğŸš€ Julia La roquette** : _Julia te donnera des dÃ©fis supplÃ©mentaires._
- **â›ï¸ Hulk le Marteau** : _Quand du code Ã  supprimer est prÃ©sent_
- **ğŸ‘¨â€âœˆï¸ Hugo le chef de projet** : _Va t'aider sur les spÃ©cifications du projet_

## ğŸœ Feedback

Remplir le formulaire le [formulaire de FeedBack](https://go.mikecodeur.com/cours-next-avis?entry.1912869708=Next%20Mastery&entry.1430994900=Clean%20Architecture&entry.533578441=03%20Services).
